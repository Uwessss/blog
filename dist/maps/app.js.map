/* fisker-blog v1.0.0 | (c) 2017  | MIT License */
{"version":3,"sources":["app.js"],"names":["global","Function","config","require","paths","slice","Promise","callback","resolve","afterPromised","mod","document","_","now","Date","_toString","Object","prototype","toString","type","call","_slice","Array","toArray","from","isArray","isArrayLike","obj","length","parseInt","_forEach","forEach","i","fn","_forInEach","key","hasOwnProperty","forIn","_map","map","arr","_filter","filter","filted","push","assign","arguments","target","hash","parse","pieces","split","data","decodeURIComponent","build","encodeURIComponent","sort","join","search","localforage","setItem","then","getItem","markdown","all","marked","mods","highlight","setOptions","lang","getLanguage","value","highlightAuto","escapeHtmlChar","reUnescapedHtml","escape","s","replace","templates","github","token","remaining","reset","Math","random","head","removeChild","window","callbackName","randomId","script","createElement","params","access_token","src","GITHUB_ISSUES_API_BASE","appendChild","gc","onerror","reject","handleResponse","response","message","meta","anonymousToken","rest","getToken","request","getElementsByTagName","ANONYMOUS_TOKEN_LIMIT","ASSUME_TOKEN_LIMIT","newToken","tokens","accessTokens","url","api","repoId","concat","owner","repo","get","resetTokenRemaining","catch","requestWithToken","index","cached","pageSize","pages","page","time","per_page","storage","article","Link","ETag","created_at","item","title","number","INDEX_STORAGE_KEY","expireTime","cache","render","fetch","id","ARTICLES_STORAGE_KEY","body","html","app","container","innerHTML","console","trace","name","query","location","showLoading","promise","showArticle","label","alert","history","go","showIndex","getElementById","run","showPage","addEventListener"],"mappings":"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","file":"../app.js","sourcesContent":["\n;(function() {\n  const global = Function('return this')()\n  const config = {\"api\":\"https://api.github.com\",\"accessTokens\":[[\"5\",\"a41e75c8b2\",\"2c70d70b08ae21\",\"5cd774758e3b8b0\"]],\"cache\":{\"index\":5000,\"article\":60000},\"name\":\"fisker's blog\",\"owner\":\"fisker\",\"repo\":\"blog\",\"pageSize\":30,\"paths\":{\"require-js\":\"https://cdn.bootcss.com/require.js/2.3.5/require.min.js\",\"localforage\":\"https://cdn.bootcss.com/localforage/1.5.0/localforage.min.js\",\"es6-promise\":\"https://cdn.bootcss.com/es6-promise/4.1.1/es6-promise.min.js\",\"highlight-js\":\"https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js\",\"marked\":\"https://cdn.bootcss.com/marked/0.3.6/marked.min.js\",\"primer-markdown\":\"https://unpkg.com/primer-markdown@3.6.0/build/build.css\",\"highlight-js-css\":\"https://cdn.bootcss.com/highlight.js/9.12.0/styles/solarized-light.min.css\"}}\n  const require = global.require\n\n  require.config({\n    paths: {\n      'localforage': config.paths['localforage'].slice(0, -3),\n      'es6-promise': config.paths['es6-promise'].slice(0, -3),\n      'highlight-js': config.paths['highlight-js'].slice(0, -3),\n      'marked': config.paths['marked'].slice(0, -3),\n    }\n  })\n\n  let Promise = global.Promise\n  ;(function(callback) {\n    if (!Promise) {\n  require(['es6-promise'], function(mod) {\n    Promise = mod.Promise\n    afterPromised()\n  })\n} else {\n  afterPromised()\n}\n\nfunction afterPromised() {\n  callback(function(mod) {\n    return new Promise(function(resolve, reject) {\n      require([mod], function(mod) {\n        resolve(mod)\n      })\n    })\n  })\n}\n\n  })\n  (function(require) {\n    const document = global.document\n\n    const _ = (function() {\n  const _ = global._ || (global._ = {})\n\n  _.now = Date.now || function() {\n    return + new Date()\n  }\n\n  _.require = require\n  _.Promise = Promise\n\n  const _toString = Object.prototype.toString\n  _.type = function(obj) {\n    return _toString.call(obj).slice(7, -1)\n  }\n\n  const _slice = Array.prototype.slice\n  _.toArray = Array.from || function(obj) {\n    return _slice.call(obj)\n  }\n\n  _.isArray = Array.isArray || function(obj) {\n    return _.type(obj) === 'Array'\n  }\n\n  _.isArrayLike = function(obj) {\n    return _.isArray(obj) ||\n      (obj && _.type(obj.length) === 'Number' && parseInt(obj.length, 10) === obj.length)\n  }\n\n  const _forEach = Array.prototype.forEach || function(fn) {\n    for (let i = 0; i < this.length; i++) {\n      fn.call(this, this[i], i, this)\n    }\n  }\n\n  const _forInEach = function(obj, fn) {\n    for (let key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        fn.call(obj, obj[key], key, obj)\n      }\n    }\n  }\n\n  _.forIn = _forInEach\n\n  _.forEach = function(obj, fn) {\n    (_.isArrayLike(obj) ? _forEach : _forInEach).call(obj, fn)\n  }\n\n  const _map = Array.prototype.map || function(fn) {\n    const arr = []\n    for (let i = 0; i < this.length; i++) {\n      arr[i] = fn.call(this, this[i], i, this)\n    }\n\n    return arr\n  }\n\n  _.map = function(obj, fn) {\n    return _map.call(obj, fn)\n  }\n\n  const _filter = Array.prototype.filter || function(fn) {\n    const filted = []\n    for (let i = 0; i < this.length; i++) {\n      let result = fn.call(this, this[i], i, this)\n      if (result) {\n        filted.push(this[i])\n      }\n    }\n    return filted\n  }\n\n  _.filter = function(obj, fn) {\n    return _filter.call(obj, fn)\n  }\n\n  _.assign = Object.assign || function(target) {\n    _.forEach(_slice.call(arguments, 1), function(source) {\n      _.forEach(source, function(value, key) {\n        target[key] = value\n      })\n    })\n\n    return target\n  }\n\n  _.hash = (function() {\n    function parseHash(hash) {\n      hash = hash.slice(2)\n      const pieces = hash ? hash.split('/') : []\n      const data = {}\n\n      for (let i = 0; i < pieces.length; i += 2) {\n        data[decodeURIComponent(pieces[i])] = decodeURIComponent(\n          pieces[i + 1] || ''\n        )\n      }\n\n      return data\n    }\n\n    function hashLink(data) {\n      const hash = []\n      _forInEach(data, function(value, key) {\n        hash.push(encodeURIComponent(key) + '/' + encodeURIComponent(value))\n      })\n\n      return '#/' + hash.sort().join('/')\n    }\n\n    return {\n      parse: parseHash,\n      build: hashLink\n    }\n  })()\n\n  _.search = (function() {\n    function buildQuery(data) {\n      const search = []\n      _forInEach(data, function(value, key) {\n        search.push(encodeURIComponent(key) + '=' + encodeURIComponent(value))\n      })\n\n      return search.join('&')\n    }\n\n    return {\n      build: buildQuery\n    }\n  })()\n\n  // const templateCompiled = {}\n  // const templateOptions = {\n  //   _: _,\n  //   config: config\n  // }\n\n  // _.template = (function(template) {\n  //   if (templateCompiled[template]) {\n  //     return templateCompiled[template]\n  //   }\n  //   return require('lodash.template')\n  //     .then(function(engine) {\n  //       return templateCompiled[template] = engine(template, templateOptions)\n  //     })\n  // })\n\n  // _.render = function(template) {\n  //   return function(data) {\n  //     return Promise.resolve(_.template(template)).then(function(compiled) {\n  //       return compiled(data)\n  //     })\n  //   }\n  // }\n\n  _.localforage = (function() {\n    function setItem(key, value) {\n      return require('localforage').then(function(localforage) {\n        return localforage.setItem.call(localforage, key, value)\n      })\n    }\n\n    function getItem(key) {\n      return require('localforage').then(function(localforage) {\n        return localforage.getItem.call(localforage, key)\n      })\n    }\n\n    return {\n      setItem: setItem,\n      getItem: getItem\n    }\n  })()\n\n  _.markdown = function(code, options) {\n    return Promise.all([require('marked'), require('highlight-js')]).then(function(mods) {\n      const marked = mods[0]\n      const highlight = mods[1]\n      marked.setOptions({\n        highlight: function(code, lang) {\n          if (lang && highlight.getLanguage(lang)) {\n            return highlight.highlight(lang, code).value\n          } else {\n            return highlight.highlightAuto(code).value\n          }\n        }\n      })\n\n      return marked(code, options)\n    })\n  }\n\n  const escapeHtmlChar = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '`': '&#96;'\n  }\n  const reUnescapedHtml = /[&<>\"'`]/g\n  _.escape = function(s) {\n    return (s + '').replace(reUnescapedHtml, function(c) {\n      return escapeHtmlChar[c]\n    })\n  }\n\n  return _\n})()\n\n    // avoid use with in strict mode\n    \n    /**\n * @license\n * Lodash (Custom Build) lodash.com/license | Underscore.js  underscorejs.org/LICENSE\n * Build: `lodash exports=\"none\" iife=\"(function(){%output%;return templates})()\" template=\"./build/temp/*.jst\" -o ./build/temp/templates.js`\n */\n    const templates = Function('config', \"return (function(){var f=typeof self==\\\"object\\\"&&self&&self.Object===Object&&self,e=(typeof global==\\\"object\\\"&&global&&global.Object===Object&&global||f||Function(\\\"return this\\\")())._||{};return{article:function(c){c||(c={});var a,b=\\\"\\\",d=e.escape;with(c)b+='<article class=\\\"article\\\"><h1 class=\\\"article__title\\\">'+d(data.title)+'</h1><header class=\\\"article__author\\\"><!-- <img class=\\\"article__author-avatar\\\" src=\\\"'+(null==(a=data.user.avatar_url+\\\"&s=40\\\")?\\\"\\\":a)+'\\\"> --><div>'+d(data.created_at)+'</div></header><hr><div class=\\\"markdown-body\\\">'+(null==(a=data.html)?\\\"\\\":a)+\\\"</div><footer>\\\",\\ndata.labels.forEach(function(t){b+='<a href=\\\"'+(null==(a=e.hash.build({label:t.name}))?\\\"\\\":a)+'\\\" style=\\\"background:#'+(null==(a=t.color)?\\\"\\\":a)+'\\\">'+d(t.name)+\\\"</a>\\\"}),b+=\\\"</footer></article>\\\";return b},index:function(c){c||(c={});var a=\\\"\\\",b=e.escape;with(c)a+=\\\"<h1>\\\"+b(config.name)+'</h1><hr><ul class=\\\"list\\\">',data.forEach(function(t){a+='<li class=\\\"list__item\\\"><a class=\\\"list__title\\\" href=\\\"'+b(e.hash.build({id:t.number}))+'\\\">'+b(t.title)+'</a><div class=\\\"list__meta\\\">\\\\n        #'+b(t.number)+'\\\\n        posted at\\\\n        <time class=\\\"list__time\\\" datetime=\\\"'+b(t.created_at)+'\\\">'+b(t.created_at)+\\\"</time></div></li>\\\";\\n}),a+=\\\"</ul>\\\",meta.Link&&(a+='<hr><nav class=\\\"pagination\\\">',meta.Link.forEach(function(t){a+='<a href=\\\"'+b(e.hash.build({page:t[0].match(/[?&]page=(\\\\d+)/)[1]}))+'\\\" title=\\\"'+b(t[1].rel)+'\\\">'+b(t[1].rel)+\\\"</a>\\\"}),a+=\\\"</nav>\\\");return a}}})();\")(config)\n\n    const github = (function() {\n  const head = document.head || document.getElementsByTagName('head')[0]\n  const ANONYMOUS_TOKEN_LIMIT = 60\n  const ASSUME_TOKEN_LIMIT = 5000\n  let timeDiff = 0\n  const anonymousToken = newToken('')\n  const tokens = _.map(config.accessTokens, function(token) {\n    if (_.isArray(token)) {\n      token = token.join('')\n    }\n\n    return newToken(token)\n  })\n\n  const GITHUB_ISSUES_API_BASE = (function() {\n    let url = [config.api]\n    if (config.repoId) {\n      url = url.concat(['repositories', config.repoId])\n    } else {\n      url = url.concat(['repos', config.owner, config.repo])\n    }\n    url.push('issues')\n\n    return url.join('/')\n  })()\n\n  function newToken(token) {\n    return {\n      token: token,\n      remaining: token ? ASSUME_TOKEN_LIMIT : ANONYMOUS_TOKEN_LIMIT,\n      reset: 0\n    }\n  }\n\n  function randomId() {\n    return (Math.random() * _.now())\n      .toString(16)\n      .replace('.', '')\n      .slice(0, 6)\n  }\n\n  function request(path, params, token) {\n    token = token || {}\n    const callbackName = 'jsonp_' + randomId()\n    const script = document.createElement('script')\n    params = _.assign({}, params, {\n      callback: callbackName\n    })\n\n    if (token.token) {\n      params.access_token = token.token\n    }\n\n    script.src = GITHUB_ISSUES_API_BASE + path + '?' + _.search.build(params)\n    head.appendChild(script)\n\n    function gc() {\n      head.removeChild(script)\n      window[callbackName] = null\n    }\n\n    return new Promise(function(resolve, reject) {\n      window[callbackName] = function(response) {\n        resolve(response)\n        gc()\n      }\n      script.onerror = function(err) {\n        reject(err)\n        gc()\n      }\n    }).then(function(data) {\n      return handleResponse(data, token)\n    })\n  }\n\n  function handleResponse(response, token) {\n    if (!response || !response.data) {\n      return Promise.reject('no data found.')\n    }\n\n    if (response.data.message) {\n      return Promise.reject(response.data.message)\n    }\n\n    const meta = response.meta\n    if (meta) {\n      const remaining = meta['X-RateLimit-Remaining']\n      const reset = meta['X-RateLimit-Reset']\n\n      if (remaining) {\n        token.remaining = parseInt(remaining, 10)\n      }\n\n      if (reset) {\n        token.reset = parseInt(remaining, 10) * 1000\n      }\n    }\n\n    return response\n  }\n\n  function resetTokenRemaining(token) {\n    if (!token.remaining) {\n      if (_.now() - anonymousToken.rest > 2 * 1000 * 1000) {\n        token.remaining = ASSUME_TOKEN_LIMIT\n      }\n    }\n\n    return token\n  }\n\n  function getToken() {\n    _.forEach(tokens, resetTokenRemaining)\n    return _.filter(tokens, function(token) {\n      return token.remaining\n    })[0]\n  }\n\n  function requestWithToken(path, params) {\n    const token = getToken()\n\n    return token\n      ? request(path, params, token)\n      : Promise.reject('no token')\n  }\n\n  function get(path, params) {\n    resetTokenRemaining(anonymousToken)\n\n    if (anonymousToken.remaining) {\n      return request(path, params, anonymousToken).catch(function() {\n        return requestWithToken(path, params)\n      })\n    } else {\n      return requestWithToken(path, params)\n    }\n  }\n\n  return {\n    get: get\n  }\n})()\n\n    const index = (function() {\n  const INDEX_STORAGE_KEY = 'index'\n  const expireTime = (config.cache && config.cache.index) || 0\n  const render = templates.index\n\n  function cached(page) {\n    if (!expireTime) {\n      return\n    }\n    return _.localforage.getItem(INDEX_STORAGE_KEY).then(function(cached) {\n      if (!cached || cached.pageSize !== config.pageSize) {\n        return\n      }\n      let data = cached.pages[page - 1]\n      if (!data || !data.time || _.now() - data.time > expireTime) {\n        return\n      }\n      return data\n    })\n  }\n\n  function fetch(page) {\n    return github.get('', {\n        page: page,\n        per_page: config.pageSize\n      })\n      .then(function(data) {\n        storage(data, page)\n        return data\n      })\n  }\n\n  function storage(data, page) {\n    article.storage({\n      data: data.data\n    })\n\n    if (!expireTime) {\n      return data\n    }\n    return _.localforage\n      .getItem(INDEX_STORAGE_KEY)\n      .then(function(cached) {\n        if (!cached || cached.pageSize !== config.pageSize) {\n          cached = {\n            pages: [],\n            pageSize: config.pageSize\n          }\n        }\n\n        cached.pages[page - 1] = {\n          meta: {\n            Link: data.meta.Link,\n            ETag: data.meta.ETag\n          },\n          time: _.now(),\n          data: []\n        }\n\n        cached.pages[page - 1].data = data.data.map(function(item) {\n          return {\n            created_at: item.created_at,\n            title: item.title,\n            number: item.number\n          }\n        })\n\n        cached.time = _.now()\n\n        return cached\n      })\n      .then(function(cached) {\n        return _.localforage.setItem(INDEX_STORAGE_KEY, cached)\n      })\n      .then(function() {\n        return data\n      })\n  }\n\n  function get(page) {\n    page = parseInt(page, 10) || 1\n    if (page < 1) {\n      page = 1\n    }\n\n    return Promise.resolve()\n      .then(function() {\n        return cached(page)\n      })\n      .then(function(data) {\n        return data ? data : fetch(page)\n      })\n  }\n\n  return {\n    get: get,\n    storage: storage,\n    render: render\n  }\n})()\n\n    \nconst article = (function() {\n  const ARTICLES_STORAGE_KEY = 'articles'\n  const expireTime = (config.cache && config.cache.index) || 0\n  const render = templates.article\n\n  function cached(id) {\n    if (!expireTime) {\n      return\n    }\n\n    return _.localforage.getItem(ARTICLES_STORAGE_KEY).then(function(cached) {\n      const data = cached && cached[id]\n      if (!data || !data.time || _.now() - data.time > expireTime) {\n        return\n      }\n      return data\n    })\n  }\n\n  function fetch(id) {\n    return github.get('/' + id).then(function(data) {\n      storage(data)\n      return data\n    })\n  }\n\n  function storage(data) {\n    if (!expireTime) {\n      return data\n    }\n\n    return _.localforage\n      .getItem(ARTICLES_STORAGE_KEY)\n      .then(function(cached) {\n        cached = cached || {}\n\n        if(data.data.forEach) {\n          data.data.forEach(function(item) {\n            cached[item.number] = {\n              data: item,\n              id: item.number,\n              time: _.now(),\n              meta: {\n                ETag: data.meta && data.meta.ETag\n              }\n            }\n          })\n        } else {\n          cached[data.data.number] = {\n            data: data.data,\n            id: data.data.number,\n            time: _.now(),\n            meta: {\n              ETag: data.meta && data.meta.ETag\n            }\n          }\n        }\n\n        return cached\n      })\n      .then(function(cached) {\n        return _.localforage.setItem(ARTICLES_STORAGE_KEY, cached)\n      })\n      .then(function() {\n        return data\n      })\n  }\n\n  function get(id) {\n    id = +id\n\n    return Promise.resolve()\n      .then(function() {\n        return cached(id)\n      })\n      .then(function(data) {\n        return data ? data : fetch(id)\n      })\n      .then(function(data) {\n        return _.markdown(data.data.body).then(function(html) {\n          data.data.html = html\n          return data\n        })\n      })\n  }\n\n  return {\n    get: get,\n    storage: storage,\n    render: render\n  }\n})()\n\n    const app = (function() {\n  var container = document.getElementById('js-app')\n\n  function showHTML(html) {\n    container.innerHTML = html\n  }\n\n  function showError(err) {\n    console.trace(err)\n    container.innerHTML =\n      'error occured <button onclick=\"location.reload()\">retry</button>'\n  }\n\n  function showIndex(page) {\n    document.title = config.name\n    return index.get(page).then(index.render)\n  }\n\n  function showArticle(id) {\n    return article.get(id).then(function(data){\n      document.title = data.data.title\n      return data\n    }).then(article.render)\n  }\n\n  function showLoading() {\n    container.innerHTML = 'loading...'\n  }\n\n  function showPage() {\n\n    const query = _.hash.parse(window.location.hash)\n    showLoading()\n    let promise\n\n    if (query.id) {\n      promise = showArticle(query.id)\n    } else if(query.label) {\n      alert('暂时不支持标签')\n      window.history.go(-1)\n      return\n    } else {\n      promise = showIndex(query.page)\n    }\n\n    return promise.then(showHTML).catch(showError)\n  }\n\n  function run() {\n    showPage()\n    window.addEventListener('hashchange', showPage, false)\n  }\n\n  return {\n    run: run\n  }\n})()\n\n\n    app.run()\n  })\n})()\n"]}