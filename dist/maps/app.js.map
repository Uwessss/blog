/* fisker-blog v1.0.0 | (c) 2018 fisker Cheung | MIT License */
{"version":3,"sources":["app.js"],"names":["global","Function","config","require","Promise","callback","afterPromised","mod","resolve","document","_","now","Date","_toString","Object","prototype","toString","type","obj","call","slice","_slice","Array","toArray","from","isArray","isArrayLike","length","parseInt","_forEach","forEach","fn","i","_forInEach","key","hasOwnProperty","forIn","_map","map","arr","_filter","filter","result","filted","push","assign","target","arguments","source","value","hash","parse","pieces","split","data","decodeURIComponent","build","encodeURIComponent","sort","join","search","localforage","setItem","then","getItem","markdown","code","options","all","mods","marked","highlight","setOptions","lang","getLanguage","highlightAuto","escapeHtmlChar","reUnescapedHtml","escape","s","replace","c","templates","github","newToken","token","remaining","reset","randomId","Math","random","request","path","params","gc","head","removeChild","script","window","callbackName","createElement","access_token","src","GITHUB_ISSUES_API_BASE","appendChild","reject","response","onerror","err","handleResponse","message","meta","resetTokenRemaining","anonymousToken","rest","getToken","tokens","requestWithToken","getElementsByTagName","accessTokens","url","api","repoId","concat","owner","repo","get","catch","index","cached","page","expireTime","pageSize","pages","time","fetch","per_page","storage","article","Link","ETag","item","created_at","title","number","cache","render","id","body","html","app","showHTML","container","innerHTML","showError","console","trace","showIndex","name","showArticle","showLoading","showPage","query","location","promise","label","alert","history","go","getElementById","run","addEventListener"],"mappings":"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","file":"../app.js","sourcesContent":["\n;(function() {\n  const global = Function('return this')()\n  const config = {\n  \"api\": \"//api.github.com\",\n  \"accessTokens\": [\n    [\n      \"5\",\n      \"a41e75c8b2\",\n      \"2c70d70b08ae21\",\n      \"5cd774758e3b8b0\"\n    ]\n  ],\n  \"cache\": {\n    \"index\": 5000,\n    \"article\": 60000\n  },\n  \"name\": \"fisker's blog\",\n  \"owner\": \"fisker\",\n  \"repo\": \"blog\",\n  \"pageSize\": 30,\n  \"require\": {\n    \"paths\": {\n      \"marked\": \"//cdn.bootcss.com/marked/0.4.0/marked.min\",\n      \"highlight-js\": \"//cdn.bootcss.com/highlight.js/9.12.0/highlight.min\",\n      \"es6-promise\": \"//cdn.bootcss.com/es6-promise/4.1.1/es6-promise.min\",\n      \"localforage\": \"//cdn.bootcss.com/localforage/1.7.1/localforage.min\"\n    }\n  }\n}\n  const require = global.require\n\n  require.config(config.require)\n\n  let Promise = global.Promise\n  ;(function(callback) {\n    if (!Promise) {\n  require(['es6-promise'], function(mod) {\n    Promise = mod.Promise\n    afterPromised()\n  })\n} else {\n  afterPromised()\n}\n\nfunction afterPromised() {\n  callback(function(mod) {\n    return new Promise(function(resolve, reject) {\n      require([mod], function(mod) {\n        resolve(mod)\n      })\n    })\n  })\n}\n\n  })\n  (function(require) {\n    const document = global.document\n\n    const _ = (function() {\n  const _ = global._ || (global._ = {})\n\n  _.now = Date.now || function() {\n    return + new Date()\n  }\n\n  _.require = require\n  _.Promise = Promise\n\n  const _toString = Object.prototype.toString\n  _.type = function(obj) {\n    return _toString.call(obj).slice(7, -1)\n  }\n\n  const _slice = Array.prototype.slice\n  _.toArray = Array.from || function(obj) {\n    return _slice.call(obj)\n  }\n\n  _.isArray = Array.isArray || function(obj) {\n    return _.type(obj) === 'Array'\n  }\n\n  _.isArrayLike = function(obj) {\n    return _.isArray(obj) ||\n      (obj && _.type(obj.length) === 'Number' && parseInt(obj.length, 10) === obj.length)\n  }\n\n  const _forEach = Array.prototype.forEach || function(fn) {\n    for (let i = 0; i < this.length; i++) {\n      fn.call(this, this[i], i, this)\n    }\n  }\n\n  const _forInEach = function(obj, fn) {\n    for (let key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        fn.call(obj, obj[key], key, obj)\n      }\n    }\n  }\n\n  _.forIn = _forInEach\n\n  _.forEach = function(obj, fn) {\n    (_.isArrayLike(obj) ? _forEach : _forInEach).call(obj, fn)\n  }\n\n  const _map = Array.prototype.map || function(fn) {\n    const arr = []\n    for (let i = 0; i < this.length; i++) {\n      arr[i] = fn.call(this, this[i], i, this)\n    }\n\n    return arr\n  }\n\n  _.map = function(obj, fn) {\n    return _map.call(obj, fn)\n  }\n\n  const _filter = Array.prototype.filter || function(fn) {\n    const filted = []\n    for (let i = 0; i < this.length; i++) {\n      let result = fn.call(this, this[i], i, this)\n      if (result) {\n        filted.push(this[i])\n      }\n    }\n    return filted\n  }\n\n  _.filter = function(obj, fn) {\n    return _filter.call(obj, fn)\n  }\n\n  _.assign = Object.assign || function(target) {\n    _.forEach(_slice.call(arguments, 1), function(source) {\n      _.forEach(source, function(value, key) {\n        target[key] = value\n      })\n    })\n\n    return target\n  }\n\n  _.hash = (function() {\n    function parseHash(hash) {\n      hash = hash.slice(2)\n      const pieces = hash ? hash.split('/') : []\n      const data = {}\n\n      for (let i = 0; i < pieces.length; i += 2) {\n        data[decodeURIComponent(pieces[i])] = decodeURIComponent(\n          pieces[i + 1] || ''\n        )\n      }\n\n      return data\n    }\n\n    function hashLink(data) {\n      const hash = []\n      _forInEach(data, function(value, key) {\n        hash.push(encodeURIComponent(key) + '/' + encodeURIComponent(value))\n      })\n\n      return '#/' + hash.sort().join('/')\n    }\n\n    return {\n      parse: parseHash,\n      build: hashLink\n    }\n  })()\n\n  _.search = (function() {\n    function buildQuery(data) {\n      const search = []\n      _forInEach(data, function(value, key) {\n        search.push(encodeURIComponent(key) + '=' + encodeURIComponent(value))\n      })\n\n      return search.join('&')\n    }\n\n    return {\n      build: buildQuery\n    }\n  })()\n\n  // const templateCompiled = {}\n  // const templateOptions = {\n  //   _: _,\n  //   config: config\n  // }\n\n  // _.template = (function(template) {\n  //   if (templateCompiled[template]) {\n  //     return templateCompiled[template]\n  //   }\n  //   return require('lodash.template')\n  //     .then(function(engine) {\n  //       return templateCompiled[template] = engine(template, templateOptions)\n  //     })\n  // })\n\n  // _.render = function(template) {\n  //   return function(data) {\n  //     return Promise.resolve(_.template(template)).then(function(compiled) {\n  //       return compiled(data)\n  //     })\n  //   }\n  // }\n\n  _.localforage = (function() {\n    function setItem(key, value) {\n      return require('localforage').then(function(localforage) {\n        return localforage.setItem.call(localforage, key, value)\n      })\n    }\n\n    function getItem(key) {\n      return require('localforage').then(function(localforage) {\n        return localforage.getItem.call(localforage, key)\n      })\n    }\n\n    return {\n      setItem: setItem,\n      getItem: getItem\n    }\n  })()\n\n  _.markdown = function(code, options) {\n    return Promise.all([require('marked'), require('highlight-js')]).then(function(mods) {\n      const marked = mods[0]\n      const highlight = mods[1]\n      marked.setOptions({\n        highlight: function(code, lang) {\n          if (lang && highlight.getLanguage(lang)) {\n            return highlight.highlight(lang, code).value\n          } else {\n            return highlight.highlightAuto(code).value\n          }\n        }\n      })\n\n      return marked(code, options)\n    })\n  }\n\n  const escapeHtmlChar = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '`': '&#96;'\n  }\n  const reUnescapedHtml = /[&<>\"'`]/g\n  _.escape = function(s) {\n    return (s + '').replace(reUnescapedHtml, function(c) {\n      return escapeHtmlChar[c]\n    })\n  }\n\n  return _\n})()\n\n    // avoid use with in strict mode\n    \n    /**\n * @license\n * Lodash (Custom Build) lodash.com/license | Underscore.js  underscorejs.org/LICENSE\n * Build: `lodash exports=\"none\" iife=\"(function(){%output%;return templates})()\" template=\"./build/temp/*.jst\" -o ./build/temp/templates.js`\n */\n    const templates = Function('config', \"return (function(){var f=typeof self==\\\"object\\\"&&self&&self.Object===Object&&self,e=(typeof global==\\\"object\\\"&&global&&global.Object===Object&&global||f||Function(\\\"return this\\\")())._||{};return{article:function(c){c||(c={});var a,b=\\\"\\\",d=e.escape;with(c)b+='<article class=\\\"article\\\"><h1 class=\\\"article__title\\\">'+d(data.title)+'</h1><header class=\\\"article__author\\\"><!-- <img class=\\\"article__author-avatar\\\" src=\\\"'+(null==(a=data.user.avatar_url+\\\"&s=40\\\")?\\\"\\\":a)+'\\\"> --><div>'+d(data.created_at)+'</div></header><hr><div class=\\\"markdown-body\\\">'+(null==(a=data.html)?\\\"\\\":a)+\\\"</div><footer>\\\",\\ndata.labels.forEach(function(t){b+='<a href=\\\"'+(null==(a=e.hash.build({label:t.name}))?\\\"\\\":a)+'\\\" style=\\\"background:#'+(null==(a=t.color)?\\\"\\\":a)+'\\\">'+d(t.name)+\\\"</a>\\\"}),b+=\\\"</footer></article>\\\";return b},index:function(c){c||(c={});var a=\\\"\\\",b=e.escape;with(c)a+=\\\"<h1>\\\"+b(config.name)+'</h1><hr><ul class=\\\"list\\\">',data.forEach(function(t){a+='<li class=\\\"list__item\\\"><a class=\\\"list__title\\\" href=\\\"'+b(e.hash.build({id:t.number}))+'\\\">'+b(t.title)+'</a><div class=\\\"list__meta\\\"> #'+b(t.number)+' posted at <time class=\\\"list__time\\\" datetime=\\\"'+b(t.created_at)+'\\\">'+b(t.created_at)+\\\"</time></div></li>\\\";\\n}),a+=\\\"</ul>\\\",meta.Link&&(a+='<hr><nav class=\\\"pagination\\\">',meta.Link.forEach(function(t){a+='<a href=\\\"'+b(e.hash.build({page:t[0].match(/[?&]page=(\\\\d+)/)[1]}))+'\\\" title=\\\"'+b(t[1].rel)+'\\\">'+b(t[1].rel)+\\\"</a>\\\"}),a+=\\\"</nav>\\\");return a}}})();\")(config)\n\n    const github = (function() {\n  const head = document.head || document.getElementsByTagName('head')[0]\n  const ANONYMOUS_TOKEN_LIMIT = 60\n  const ASSUME_TOKEN_LIMIT = 5000\n  let timeDiff = 0\n  const anonymousToken = newToken('')\n  const tokens = _.map(config.accessTokens, function(token) {\n    if (_.isArray(token)) {\n      token = token.join('')\n    }\n\n    return newToken(token)\n  })\n\n  const GITHUB_ISSUES_API_BASE = (function() {\n    let url = [config.api]\n    if (config.repoId) {\n      url = url.concat(['repositories', config.repoId])\n    } else {\n      url = url.concat(['repos', config.owner, config.repo])\n    }\n    url.push('issues')\n\n    return url.join('/')\n  })()\n\n  function newToken(token) {\n    return {\n      token: token,\n      remaining: token ? ASSUME_TOKEN_LIMIT : ANONYMOUS_TOKEN_LIMIT,\n      reset: 0\n    }\n  }\n\n  function randomId() {\n    return (Math.random() * _.now())\n      .toString(16)\n      .replace('.', '')\n      .slice(0, 6)\n  }\n\n  function request(path, params, token) {\n    token = token || {}\n    const callbackName = 'jsonp_' + randomId()\n    const script = document.createElement('script')\n    params = _.assign({}, params, {\n      callback: callbackName\n    })\n\n    if (token.token) {\n      params.access_token = token.token\n    }\n\n    script.src = GITHUB_ISSUES_API_BASE + path + '?' + _.search.build(params)\n    head.appendChild(script)\n\n    function gc() {\n      head.removeChild(script)\n      window[callbackName] = null\n    }\n\n    return new Promise(function(resolve, reject) {\n      window[callbackName] = function(response) {\n        resolve(response)\n        gc()\n      }\n      script.onerror = function(err) {\n        reject(err)\n        gc()\n      }\n    }).then(function(data) {\n      return handleResponse(data, token)\n    })\n  }\n\n  function handleResponse(response, token) {\n    if (!response || !response.data) {\n      return Promise.reject('no data found.')\n    }\n\n    if (response.data.message) {\n      return Promise.reject(response.data.message)\n    }\n\n    const meta = response.meta\n    if (meta) {\n      const remaining = meta['X-RateLimit-Remaining']\n      const reset = meta['X-RateLimit-Reset']\n\n      if (remaining) {\n        token.remaining = parseInt(remaining, 10)\n      }\n\n      if (reset) {\n        token.reset = parseInt(remaining, 10) * 1000\n      }\n    }\n\n    return response\n  }\n\n  function resetTokenRemaining(token) {\n    if (!token.remaining) {\n      if (_.now() - anonymousToken.rest > 2 * 1000 * 1000) {\n        token.remaining = ASSUME_TOKEN_LIMIT\n      }\n    }\n\n    return token\n  }\n\n  function getToken() {\n    _.forEach(tokens, resetTokenRemaining)\n    return _.filter(tokens, function(token) {\n      return token.remaining\n    })[0]\n  }\n\n  function requestWithToken(path, params) {\n    const token = getToken()\n\n    return token\n      ? request(path, params, token)\n      : Promise.reject('no token')\n  }\n\n  function get(path, params) {\n    resetTokenRemaining(anonymousToken)\n\n    if (anonymousToken.remaining) {\n      return request(path, params, anonymousToken).catch(function() {\n        return requestWithToken(path, params)\n      })\n    } else {\n      return requestWithToken(path, params)\n    }\n  }\n\n  return {\n    get: get\n  }\n})()\n\n    const index = (function() {\n  const INDEX_STORAGE_KEY = 'index'\n  const expireTime = ((config.cache && config.cache.index) || 0) * 1000\n  const render = templates.index\n\n  function cached(page) {\n    if (!expireTime) {\n      return\n    }\n    return _.localforage.getItem(INDEX_STORAGE_KEY).then(function(cached) {\n      if (!cached || cached.pageSize !== config.pageSize) {\n        return\n      }\n      let data = cached.pages[page - 1]\n      if (!data || !data.time || _.now() - data.time > expireTime) {\n        return\n      }\n      return data\n    })\n  }\n\n  function fetch(page) {\n    return github\n      .get('', {\n        page: page,\n        per_page: config.pageSize\n      })\n      .then(function(data) {\n        storage(data, page)\n        return data\n      })\n  }\n\n  function storage(data, page) {\n    article.storage({\n      data: data.data\n    })\n\n    if (!expireTime) {\n      return data\n    }\n    return _.localforage\n      .getItem(INDEX_STORAGE_KEY)\n      .then(function(cached) {\n        if (!cached || cached.pageSize !== config.pageSize) {\n          cached = {\n            pages: [],\n            pageSize: config.pageSize\n          }\n        }\n\n        cached.pages[page - 1] = {\n          meta: {\n            Link: data.meta.Link,\n            ETag: data.meta.ETag\n          },\n          time: _.now(),\n          data: []\n        }\n\n        cached.pages[page - 1].data = data.data.map(function(item) {\n          return {\n            created_at: item.created_at,\n            title: item.title,\n            number: item.number\n          }\n        })\n\n        cached.time = _.now()\n\n        return cached\n      })\n      .then(function(cached) {\n        return _.localforage.setItem(INDEX_STORAGE_KEY, cached)\n      })\n      .then(function() {\n        return data\n      })\n  }\n\n  function get(page) {\n    page = parseInt(page, 10) || 1\n    if (page < 1) {\n      page = 1\n    }\n\n    return Promise.resolve()\n      .then(function() {\n        return cached(page)\n      })\n      .then(function(data) {\n        return data ? data : fetch(page)\n      })\n  }\n\n  return {\n    get: get,\n    storage: storage,\n    render: render\n  }\n})()\n\n    const article = (function() {\n  const ARTICLES_STORAGE_KEY = 'articles'\n  const expireTime = ((config.cache && config.cache.article) || 0) * 1000\n  const render = templates.article\n\n  function cached(id) {\n    if (!expireTime) {\n      return\n    }\n\n    return _.localforage.getItem(ARTICLES_STORAGE_KEY).then(function(cached) {\n      const data = cached && cached[id]\n      if (!data || !data.time || _.now() - data.time > expireTime) {\n        return\n      }\n      return data\n    })\n  }\n\n  function fetch(id) {\n    return github.get('/' + id).then(function(data) {\n      storage(data)\n      return data\n    })\n  }\n\n  function storage(data) {\n    if (!expireTime) {\n      return data\n    }\n\n    return _.localforage\n      .getItem(ARTICLES_STORAGE_KEY)\n      .then(function(cached) {\n        cached = cached || {}\n\n        if (data.data.forEach) {\n          data.data.forEach(function(item) {\n            cached[item.number] = {\n              data: item,\n              id: item.number,\n              time: _.now(),\n              meta: {\n                ETag: data.meta && data.meta.ETag\n              }\n            }\n          })\n        } else {\n          cached[data.data.number] = {\n            data: data.data,\n            id: data.data.number,\n            time: _.now(),\n            meta: {\n              ETag: data.meta && data.meta.ETag\n            }\n          }\n        }\n\n        return cached\n      })\n      .then(function(cached) {\n        return _.localforage.setItem(ARTICLES_STORAGE_KEY, cached)\n      })\n      .then(function() {\n        return data\n      })\n  }\n\n  function get(id) {\n    id = +id\n\n    return Promise.resolve()\n      .then(function() {\n        return cached(id)\n      })\n      .then(function(data) {\n        return data ? data : fetch(id)\n      })\n      .then(function(data) {\n        return _.markdown(data.data.body).then(function(html) {\n          data.data.html = html\n          return data\n        })\n      })\n  }\n\n  return {\n    get: get,\n    storage: storage,\n    render: render\n  }\n})()\n\n    const app = (function() {\n  var container = document.getElementById('js-app')\n\n  function showHTML(html) {\n    container.innerHTML = html\n  }\n\n  function showError(err) {\n    console.trace(err)\n    container.innerHTML =\n      'error occured <button onclick=\"location.reload()\">retry</button>'\n  }\n\n  function showIndex(page) {\n    document.title = config.name\n    return index.get(page).then(index.render)\n  }\n\n  function showArticle(id) {\n    return article.get(id).then(function(data){\n      document.title = data.data.title\n      return data\n    }).then(article.render)\n  }\n\n  function showLoading() {\n    container.innerHTML = 'loading...'\n  }\n\n  function showPage() {\n\n    const query = _.hash.parse(window.location.hash)\n    showLoading()\n    let promise\n\n    if (query.id) {\n      promise = showArticle(query.id)\n    } else if(query.label) {\n      alert('暂时不支持标签')\n      window.history.go(-1)\n      return\n    } else {\n      promise = showIndex(query.page)\n    }\n\n    return promise.then(showHTML).catch(showError)\n  }\n\n  function run() {\n    showPage()\n    window.addEventListener('hashchange', showPage, false)\n  }\n\n  return {\n    run: run\n  }\n})()\n\n\n    app.run()\n  })\n})()\n"]}